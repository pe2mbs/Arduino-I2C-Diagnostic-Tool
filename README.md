# ATMEL ATMEGA series I2C diagnostics tool.
This is a small diagnostics and debugging tool for the ATMEGA series micro controllers. It's meant to help solve problems around I2C.
This is is based on the https://github.com/romkey/ESP-Diagnostic-Tool, therefore many thanks to John Romkey.

## Why this library  
I'm very lazy, instead of looking up the documentation of each chip and finding out the address setting per I2C device, I just like to hookup the devices. Run the scanner and see the device(s) which I expect with there address(es).

## Licence
The files in the repository are under GPL2-only licence. with the exception of the file generated by the convert.py file, this file is under MIT licence as the data used is taken from https://i2cdevices.org/devices. 

## Usage
The utility runs the serial port at 115,200 bps. When loaded the I2C is investigated for all devices attached. This is handy when having multiple devices on the BUS and directly knowing the device addresses and/or seeing that all devices are correctly connected.

The I2C scanner probes each I2C address and reports which addresses respond. It also contains a list of known I2C devices by address and will report the known uses of each responding address.

To have the most up-to-date list of I2C devices run the convert.py script first (reguirment requests library only), this creates a new i2cdevices.cpp file for compiling into the tool, all data in this file is stored in flash memory. 

An I2C scan with no I2C device should look like this:

    Scanning...
    No I2C devices found

A successful I2C scan might look like this:

    Scanning...
    I2C device found at address 0x20 - Chirp!,FXAS21002,HW-061,MA12070P,MCP23008,MCP23017,PCA6408A,PCF8574,PCF8575,TCA9554,XD8574A  !
    I2C device found at address 0x50 - ADXL345,AT24C02N,AT24C64,CAT24C512,LM25066,MB85RC,PCA9685,ST25DV16K   !
    done

An I2C scan with malfunctioning hardware might look like this:

    Scanning...
    Unknown error at address 0x01
    Unknown error at address 0x02
    Unknown error at address 0x03 
    Unknown error at address 0x04
    ...

This means something is interfering with signalling on the I2C SDA and SDC lines. It's most likely an electrical or wiring problem but could possibly be a defective I2C device.

The device list is generated by the web site https://i2cdevices.org/devices

## Building and Installation
You currently have to build the firmware yourself using Arduino IDE.

### Clone the repository

    git clone https://github.com/pe2mbs/Arduino-I2C-Diagnostic-Tool.git

### Optional run the convertpy script

    cd ./Arduino-I2C-Diagnostic-Tool

    python3 convert.py

In case of No-internet connection on the machine, download the https://i2cdevices.org/devices.json manually and overwrite 
the current file. When NO internet by default the convert.py script will fallback to the local stored JSON file.

#### Error on requests library
  
On linux systems

    virtualenv venv
    source venv/bin/activate
    pip install requests
    python3 convert.py
     
On Windows systems
    
    virtualenv venv 
    venv/scripts/activate
    pip install requests
    python3 convert.py

## Compile and load the code 
Now you see the output on the serial console of Arduino IDE.



